<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="CVE-2012-0158 漏洞分析"><meta name="keywords" content="漏洞分析,栈溢出"><meta name="author" content="yangruiqi,undefined"><meta name="copyright" content="yangruiqi"><title>CVE-2012-0158 漏洞分析 | manyouyou</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.5"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="dns-prefetch" href="https://unpkg.com"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitment/style/default.min.css"><script src="https://cdn.jsdelivr.net/npm/gitment/dist/gitment.browser.min.js"></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: {"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}"},"path":"search.xml"}
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一-样本概况"><span class="toc-number">1.</span> <span class="toc-text">一 样本概况</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#样本信息"><span class="toc-number">1.1.</span> <span class="toc-text">样本信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试环境"><span class="toc-number">1.2.</span> <span class="toc-text">测试环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞原理"><span class="toc-number">1.3.</span> <span class="toc-text">漏洞原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分析目标"><span class="toc-number">1.4.</span> <span class="toc-text">分析目标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#行为分析"><span class="toc-number">2.</span> <span class="toc-text">行为分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#IDA查看"><span class="toc-number">2.1.</span> <span class="toc-text">IDA查看</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考资料："><span class="toc-number">3.</span> <span class="toc-text">参考资料：</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://raw.githubusercontent.com/yangruiqiyr/MarkdownPhotos/master/%E5%A4%B4%E5%83%8F/touxiang.jpg"></div><div class="author-info__name text-center">yangruiqi</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/yangruiqiyr" target="_blank">跟随我</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">29</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">42</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">15</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">相关网址</div><a class="author-info-links__name text-center" href="http://blog.topsec.com.cn/" target="_blank">天融信阿尔法实验室</a><a class="author-info-links__name text-center" href="https://www.baidu.com/" target="_blank">百度</a><a class="author-info-links__name text-center" href="https://bbs.pediy.com/" target="_blank">看雪</a><a class="author-info-links__name text-center" href="http://www.freebuf.com/" target="_blank">FreeBuf</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://raw.githubusercontent.com/yangruiqiyr/MarkdownPhotos/master/主题/主题1.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">manyouyou</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/archives">档案</a><a class="site-page" href="/tags">标题</a><a class="site-page" href="/categories">分类</a></span></div><div id="post-info"><div id="post-title">CVE-2012-0158 漏洞分析</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-07-28</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/报告-CVE-2012-0158漏洞分析报告/">报告 - CVE-2012-0158漏洞分析报告</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="一-样本概况"><a href="#一-样本概况" class="headerlink" title="一 样本概况"></a>一 样本概况</h1><p>一个基于栈内存越界拷贝的office漏洞。</p>
<h2 id="样本信息"><a href="#样本信息" class="headerlink" title="样本信息"></a>样本信息</h2><h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>Win7 x86<br>office 2003<br>windbg<br>火绒剑   </p>
<h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>MSCOMCTL.OCX模块是office解析ActiveX控件用到的一个动态库，当一个office相关文档中包含ActiveX这类的控件元素的话，比如按钮、列表、树形控件等，当文档通过office打开时，MSCOMCTL.OCX就会被载入到office程序的进程空间，调用其来解析显示空间，当office解析到一个被构造好的控件，比如列表控件，就会发生栈内存越界拷贝。   </p>
<h2 id="分析目标"><a href="#分析目标" class="headerlink" title="分析目标"></a>分析目标</h2><p>漏洞利用原理</p>
<h1 id="行为分析"><a href="#行为分析" class="headerlink" title="行为分析"></a>行为分析</h1><p>拿到POC，运行一下发现弹出错误，如下图：<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/2.png?x-oss-process=style/yangruiqi.com" alt="1"><br>然后运行一下样本，会弹出计算器，如下图：<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/1.png?x-oss-process=style/yangruiqi.com" alt="2"><br>所以这个exp的shellcode在运行时候会释放文件，用火绒剑观察一下，如下图：<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/3.png?x-oss-process=style/yangruiqi.com" alt="3"><br>感染PE文件，启动自释放文件。去路径下去看a.exe就是计算器。  </p>
<p>打开样本弹出计算器，所以Shellcode应该会调用WinExec函数。用Windbg附加WINWORD.EXE，bp kernel32!WinExec下断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0:009&gt; bp kernel32!WInExec</span><br><span class="line">0:009&gt; bl</span><br><span class="line"> 0 e 76d9e695     0001 (0001)  0:**** kernel32!WinExec</span><br><span class="line">0:009&gt; g</span><br></pre></td></tr></table></figure>
<p>然后g，把样本拖进word。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ModLoad: 27580000 27685000   C:\Windows\system32\MSCOMCTL.OCX</span><br><span class="line">Breakpoint 0 hit</span><br><span class="line">eax=0012163b ebx=0001c000 ecx=00121568 edx=77cc64f4 esi=0001c000 edi=0c00afe6</span><br><span class="line">eip=76d9e695 esp=00121588 ebp=001215a0 iopl=0         nv up ei pl nz na po nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</span><br><span class="line">kernel32!WinExec:</span><br><span class="line">76d9e695 8bff            mov     edi,edi</span><br></pre></td></tr></table></figure>
<p>程序断在WinExec入口点。这时候计算器还没弹出来，看一下WinExec的参数，发现是a.exe。我去到这个目录，发现它就是一个计算器。<br>看来shellcode应该是把系统的calc复制到别的目录再运行它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; dd esp</span><br><span class="line">00121588  00121852 0beaca80 00000000 0beaca80</span><br><span class="line">00121598  0001c000 00000744 001215f0 00121a78</span><br><span class="line">001215a8  0bfec2a8 0c00aff0 0001c000 00000001</span><br><span class="line">001215b8  275c8a0a 0c00aff0 0bfec2a8 0001c000</span><br><span class="line">001215c8  00000000 0bf27078 0bfec290 00002d26</span><br><span class="line">001215d8  00002d26 0bfe9a48 00002841 0002159e</span><br><span class="line">001215e8  00000000 00000744 00000000 00121669</span><br><span class="line">001215f8  1005c48b c7000001 4d032400 005ae908</span><br><span class="line">0:000&gt; da 0beaca80</span><br><span class="line">0beaca80  &quot;C:\Users\15pb-win7\a.exe&quot;</span><br></pre></td></tr></table></figure>
<p>WinExec的返回地址是0x00121852。往上翻翻，没发现shellcode从哪开始。Kb打印堆栈</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; kb</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">WARNING: Stack unwind information not available. Following frames may be wrong.</span><br><span class="line">00121584 00121852 0beaca80 00000000 0beaca80 kernel32!WinExec</span><br><span class="line">*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Windows\system32\MSCOMCTL.OCX - </span><br><span class="line">001215b4 275c8a0a 0c00aff0 0bfec2a8 0001c000 0x121852</span><br><span class="line">001215f0 00121669 1005c48b c7000001 4d032400 MSCOMCTL!DllGetClassObject+0x41cc6</span><br><span class="line">00000000 00000000 00000000 00000000 00000000 0x121669</span><br></pre></td></tr></table></figure>
<p>重新载入，在MSCOMCTL!DllGetClassObject+0x41cc0下断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">275c89fd ff75f4          push    dword ptr [ebp-0Ch]</span><br><span class="line">275c8a00 8d45f8          lea     eax,[ebp-8]</span><br><span class="line">275c8a03 53              push    ebx</span><br><span class="line">275c8a04 50              push    eax</span><br><span class="line">275c8a05 e863fdffff      call    MSCOMCTL!DllGetClassObject+0x41a29 (275c876d)</span><br><span class="line">275c8a0a 8bf0            mov     esi,eax</span><br><span class="line">275c8a0c 83c40c          add     esp,0Ch</span><br><span class="line">275c8a0f 85f6            test    esi,esi</span><br><span class="line">275c8a11 7c3d            jl      MSCOMCTL!DllGetClassObject+0x41d0c (275c8a50)</span><br><span class="line">275c8a13 837df800        cmp     dword ptr [ebp-8],0</span><br><span class="line">275c8a17 8b7d08          mov     edi,dword ptr [ebp+8]</span><br></pre></td></tr></table></figure>
<p>断在这个call的上一句，Kb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">WARNING: Stack unwind information not available. Following frames may be wrong.</span><br><span class="line">001215e8 275e701a 06642584 0d9a08e8 00000000 MSCOMCTL!DllGetClassObject+0x41cc0</span><br><span class="line">00121610 275e7361 06642584 0d9a08e8 0d9a08e8 MSCOMCTL!DLLGetDocumentation+0xd08</span><br><span class="line">00121630 275ca8b6 0bfabe80 0d9a08e8 0bfabcd8 MSCOMCTL!DLLGetDocumentation+0x104f</span><br><span class="line">001216b0 2758aee8 0bfabc88 00000000 0d9a08e8 MSCOMCTL!DllGetClassObject+0x43b72</span><br><span class="line">001216e0 27600908 0bfabcd8 0d9a08e8 00000000 MSCOMCTL!DllGetClassObject+0x41a4</span><br><span class="line">*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Program Files\Microsoft Office\OFFICE11\WINWORD.EXE - </span><br><span class="line">001216f4 301ecdcd 0bfabcdc 0d9a08e8 00000000 MSCOMCTL!DllUnregisterServer+0xc31</span><br></pre></td></tr></table></figure>
<p>发现这一层函数的返回地址是0x 275e701a，它前面一个call是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; u 275e701a -5</span><br><span class="line">MSCOMCTL!DLLGetDocumentation+0xd03:</span><br><span class="line">275e7015 e8ad19feff      call    MSCOMCTL!DllGetClassObject+0x41c83 (275c89c7)</span><br><span class="line">275e701a 85c0            test    eax,eax</span><br><span class="line">275e701c 7c27            jl      MSCOMCTL!DLLGetDocumentation+0xd33 (275e7045)</span><br></pre></td></tr></table></figure>
<p>判断溢出点就是这个call里面。</p>
<p><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/5.png?x-oss-process=style/yangruiqi.com" alt="5"></p>
<p>发现了熟悉的发现万能跳转0x7ffa4512和shellcode。并且在</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">275c8a05 e863fdffff      call    MSCOMCTL!DllGetClassObject+0x41a29 (275c876d)</span><br></pre></td></tr></table></figure>
<p>之前这里还没有被shellcode覆盖，显然，溢出发生在此<br>几个单步<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/6.png?x-oss-process=style/yangruiqi.com" alt="6"></p>
<p>Shellcode通过jmp esp覆盖返回地址利用。<br>接下来用IDA打开有漏洞的MSCOMCTL.OCX。定位前面那两个关键call，先看上层call，直接跳到文章后面打开IDA处，下面这段是另一种定位关键call的方法。</p>
<p>因为释放文件时需要调用kernel32.dll中的GetFileSize函数来判断需要释放的文件。所以Windbg开始调试POC时候，在GetFileSize函数下断，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bp kernel32!GetFileSize</span><br></pre></td></tr></table></figure></p>
<p>但是Word运行时会调用很多次GetFileSize，直接下断点的话，会执行很多次。<br>我们知道漏洞出现MSCOMCTL.OCX,因此我们可以在加载MSCOMCTL.OCX后在对GetFileSize下断点。用到命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sxe ld:MSCOMCTL.OCX</span><br></pre></td></tr></table></figure></p>
<p>加载MSCOMCTL.OCX时候会断下来。bp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">0:013&gt; sxe ld:MSCOMCTL.OCX</span><br><span class="line">0:013&gt; g</span><br><span class="line">ModLoad: 27580000 27685000   C:\Windows\system32\MSCOMCTL.OCX</span><br><span class="line">eax=00000000 ebx=00000000 ecx=30036f04 edx=77cc64f4 esi=7ffdf000 edi=0012049c</span><br><span class="line">eip=77cc64f4 esp=001203b4 ebp=00120408 iopl=0         nv up ei pl zr na pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</span><br><span class="line">ntdll!KiFastSystemCallRet:</span><br><span class="line">77cc64f4 c3              ret</span><br><span class="line">0:000&gt; bp kernel32!GetFileSize</span><br><span class="line">0:000&gt; bl</span><br><span class="line"> 0 e 768f0273     0001 (0001)  0:**** kernel32!GetFileSize</span><br></pre></td></tr></table></figure>
<p>然后g运行程序，程序停在GetFileSize处</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; g</span><br><span class="line">Breakpoint 0 hit</span><br><span class="line">eax=00121617 ebx=0dff08e8 ecx=00000049 edx=000001af esi=0012164f edi=0012165b</span><br><span class="line">eip=76d55d47 esp=001215ac ebp=001215f0 iopl=0         nv up ei pl nz ac pe nc</span><br><span class="line">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000216</span><br><span class="line">kernel32!GetFileSize:</span><br><span class="line">76d55d47 8bff            mov     edi,edi</span><br></pre></td></tr></table></figure>
<p>反汇编窗口如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">76d55d47 8bff            mov     edi,edi</span><br><span class="line">76d55d49 55              push    ebp</span><br><span class="line">76d55d4a 8bec            mov     ebp,esp</span><br><span class="line">76d55d4c 5d              pop     ebp</span><br><span class="line">76d55d4d eb05            jmp     kernel32!GetFileSize+0xd (76d55d54)</span><br><span class="line">76d55d4f 90              nop</span><br><span class="line">76d55d50 90              nop</span><br><span class="line">76d55d51 90              nop</span><br><span class="line">76d55d52 90              nop</span><br><span class="line">76d55d53 90              nop</span><br><span class="line">76d55d54 ff25d419d176    jmp     dword ptr [kernel32+0x19d4 (76d119d4)]</span><br><span class="line">76d55d5a 83c00a          add     eax,0Ah</span><br><span class="line">76d55d5d 83c10a          add     ecx,0Ah</span><br><span class="line">76d55d60 e907ab0000      jmp     kernel32!DuplicateHandle+0x236 (76d6086c)</span><br><span class="line">76d55d65 83c00c          add     eax,0Ch</span><br><span class="line">76d55d68 83c10c          add     ecx,0Ch</span><br><span class="line">76d55d6b e9fcaa0000      jmp     kernel32!DuplicateHandle+0x236 (76d6086c)</span><br><span class="line">76d55d70 90              nop</span><br><span class="line">76d55d71 90              nop</span><br><span class="line">76d55d72 90              nop</span><br><span class="line">76d55d73 90              nop</span><br><span class="line">76d55d74 90              nop</span><br></pre></td></tr></table></figure></p>
<p>然后gu跳出GetFileSize函数，程序已经进入shellcode区域</p>
<p><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/4.png?x-oss-process=style/yangruiqi.com" alt="4"></p>
<p>观察堆栈调用上一层是MSCOMCTL!DllGetClassObject+0x41cc6 处</p>
<p>观察下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0:000&gt; u MSCOMCTL!DllGetClassObject+0x41cc6</span><br><span class="line">MSCOMCTL!DllGetClassObject+0x41cc6:</span><br><span class="line">275c8a0a 8bf0            mov     esi,eax</span><br><span class="line">275c8a0c 83c40c          add     esp,0Ch</span><br><span class="line">275c8a0f 85f6            test    esi,esi</span><br><span class="line">275c8a11 7c3d            jl      MSCOMCTL!DllGetClassObject+0x41d0c (275c8a50)</span><br><span class="line">275c8a13 837df800        cmp     dword ptr [ebp-8],0</span><br><span class="line">275c8a17 8b7d08          mov     edi,dword ptr [ebp+8]</span><br><span class="line">275c8a1a 742a            je      MSCOMCTL!DllGetClassObject+0x41d02 (275c8a46)</span><br><span class="line">275c8a1c 83650c00        and     dword ptr [ebp+0Ch],0</span><br></pre></td></tr></table></figure>
<h2 id="IDA查看"><a href="#IDA查看" class="headerlink" title="IDA查看"></a>IDA查看</h2><p>猜测是判断出问题溢出，然后观察地址275c8a50处，猜测问题出在此处附近，打开IDA打开MSCOMCTL.OCX模块，定位到此处。此处反汇编如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">.text:275C89C7 ; int __stdcall sub_275C89C7(int, BSTR bstrString)</span><br><span class="line">.text:275C89C7 sub_275C89C7    proc near               ; CODE XREF: sub_275C8807+10p</span><br><span class="line">.text:275C89C7                                         ; sub_275E7004+11p ...</span><br><span class="line">.text:275C89C7</span><br><span class="line">.text:275C89C7 var_14          = dword ptr -14h</span><br><span class="line">.text:275C89C7 dwBytes         = dword ptr -0Ch</span><br><span class="line">.text:275C89C7 var_8           = dword ptr -8</span><br><span class="line">.text:275C89C7 var_4           = dword ptr -4</span><br><span class="line">.text:275C89C7 arg_0           = dword ptr  8</span><br><span class="line">.text:275C89C7 bstrString      = dword ptr  0Ch</span><br><span class="line">.text:275C89C7</span><br><span class="line">.text:275C89C7 ; FUNCTION CHUNK AT .text:275D3085 SIZE 0000001D BYTES</span><br><span class="line">.text:275C89C7</span><br><span class="line">.text:275C89C7                 push    ebp</span><br><span class="line">.text:275C89C8                 mov     ebp, esp</span><br><span class="line">.text:275C89CA                 sub     esp, 14h</span><br><span class="line">.text:275C89CD                 push    ebx</span><br><span class="line">.text:275C89CE                 mov     ebx, [ebp+bstrString]</span><br><span class="line">.text:275C89D1                 push    esi</span><br><span class="line">.text:275C89D2                 push    edi</span><br><span class="line">.text:275C89D3                 push    0Ch             ; dwBytes</span><br><span class="line">.text:275C89D5                 lea     eax, [ebp+var_14]</span><br><span class="line">.text:275C89D8                 push    ebx             ; lpMem</span><br><span class="line">.text:275C89D9                 push    eax             ; int</span><br><span class="line">.text:275C89DA                 call    sub_275C876D</span><br><span class="line">.text:275C89DF                 add     esp, 0Ch</span><br><span class="line">.text:275C89E2                 test    eax, eax</span><br><span class="line">.text:275C89E4                 jl      short loc_275C8A52</span><br><span class="line">.text:275C89E6                 cmp     [ebp+var_14], 6A626F43h</span><br><span class="line">.text:275C89ED                 jnz     loc_275D3085</span><br><span class="line">.text:275C89F3                 cmp     [ebp+dwBytes], 8</span><br><span class="line">.text:275C89F7                 jb      loc_275D3085</span><br><span class="line">.text:275C89FD                 push    [ebp+dwBytes]   ; dwBytes</span><br><span class="line">.text:275C8A00                 lea     eax, [ebp+var_8]</span><br><span class="line">.text:275C8A03                 push    ebx             ; lpMem</span><br><span class="line">.text:275C8A04                 push    eax             ; int</span><br><span class="line">.text:275C8A05                 call    sub_275C876D</span><br><span class="line">.text:275C8A0A                 mov     esi, eax</span><br><span class="line">.text:275C8A0C                 add     esp, 0Ch</span><br><span class="line">.text:275C8A0F                 test    esi, esi</span><br><span class="line">.text:275C8A11                 jl      short loc_275C8A50</span><br><span class="line">.text:275C8A13                 cmp     [ebp+var_8], 0</span><br><span class="line">.text:275C8A17                 mov     edi, [ebp+arg_0]</span><br><span class="line">.text:275C8A1A                 jz      short loc_275C8A46</span><br><span class="line">.text:275C8A1C                 and     [ebp+bstrString], 0</span><br><span class="line">.text:275C8A20                 lea     eax, [ebp+bstrString]</span><br><span class="line">.text:275C8A23                 push    ebx             ; int</span><br><span class="line">.text:275C8A24                 push    eax             ; len</span><br><span class="line">.text:275C8A25                 call    sub_275C8A59</span><br><span class="line">.text:275C8A2A                 mov     esi, eax</span><br><span class="line">.text:275C8A2C                 pop     ecx</span><br><span class="line">.text:275C8A2D                 test    esi, esi</span><br><span class="line">.text:275C8A2F                 pop     ecx</span><br><span class="line">.text:275C8A30                 jl      short loc_275C8A50</span><br><span class="line">.text:275C8A32                 push    [ebp+bstrString] ; strIn</span><br><span class="line">.text:275C8A35                 lea     ecx, [edi-24h]</span><br><span class="line">.text:275C8A38                 call    sub_27585BE7</span><br><span class="line">.text:275C8A3D                 push    [ebp+bstrString] ; bstrString</span><br><span class="line">.text:275C8A40                 call    ds:SysFreeString</span><br><span class="line">.text:275C8A46</span><br><span class="line">.text:275C8A46 loc_275C8A46:                           ; CODE XREF: sub_275C89C7+53j</span><br><span class="line">.text:275C8A46                 cmp     [ebp+var_4], 0</span><br><span class="line">.text:275C8A4A                 jnz     loc_275D308F</span><br><span class="line">.text:275C8A50</span><br><span class="line">.text:275C8A50 loc_275C8A50:                           ; CODE XREF: sub_275C89C7+4Aj</span><br><span class="line">.text:275C8A50                                         ; sub_275C89C7+69j ...</span><br><span class="line">.text:275C8A50                 mov     eax, esi</span><br><span class="line">.text:275C8A52</span><br><span class="line">.text:275C8A52 loc_275C8A52:                           ; CODE XREF: sub_275C89C7+1Dj</span><br><span class="line">.text:275C8A52                                         ; sub_275C89C7+A6C3j</span><br><span class="line">.text:275C8A52                 pop     edi</span><br><span class="line">.text:275C8A53                 pop     esi</span><br><span class="line">.text:275C8A54                 pop     ebx</span><br><span class="line">.text:275C8A55                 leave</span><br><span class="line">.text:275C8A56                 retn    8</span><br><span class="line">.text:275C8A56 sub_275C89C7    endp</span><br></pre></td></tr></table></figure>
<p>F5反编译一下如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">stdcall <span class="title">sub_275C89C7</span><span class="params">(<span class="keyword">int</span> a1, BSTR bstrString)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  BSTR v2; <span class="comment">// ebx@1</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// esi@4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+Ch] [bp-14h]@1</span></span><br><span class="line">  SIZE_T dwBytes; <span class="comment">// [sp+14h] [bp-Ch]@3</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+18h] [bp-8h]@4</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [sp+1Ch] [bp-4h]@8</span></span><br><span class="line"></span><br><span class="line">  v2 = bstrString;</span><br><span class="line">  result = sub_275C876D((<span class="keyword">int</span>)&amp;v5, bstrString, <span class="number">0xC</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( result &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5 == <span class="number">1784835907</span> &amp;&amp; dwBytes &gt;= <span class="number">8</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = sub_275C876D((<span class="keyword">int</span>)&amp;v7, v2, dwBytes);</span><br><span class="line">      <span class="keyword">if</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !v7 )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">        bstrString = <span class="number">0</span>;</span><br><span class="line">        v4 = sub_275C8A59((UINT)&amp;bstrString, (<span class="keyword">int</span>)v2);</span><br><span class="line">        <span class="keyword">if</span> ( v4 &gt;= <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          sub_27585BE7(bstrString);</span><br><span class="line">          SysFreeString(bstrString);</span><br><span class="line">LABEL_8:</span><br><span class="line">          <span class="keyword">if</span> ( v8 )</span><br><span class="line">            v4 = sub_275C8B2B(a1 + <span class="number">20</span>, v2);</span><br><span class="line">          <span class="keyword">return</span> v4;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> v4;</span><br><span class="line">    &#125;</span><br><span class="line">    result = <span class="number">-2147418113</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_275C876D</span><span class="params">(<span class="keyword">int</span> a1, LPVOID lpMem, SIZE_T dwBytes)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  LPVOID v3; <span class="comment">// ebx@1</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax@1</span></span><br><span class="line">  LPVOID v5; <span class="comment">// eax@3</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// esi@4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+Ch] [bp-4h]@1</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">void</span> *lpMema; <span class="comment">// [sp+1Ch] [bp+Ch]@3</span></span><br><span class="line"></span><br><span class="line">  v3 = lpMem;</span><br><span class="line">  result = (*(<span class="keyword">int</span> (__stdcall **)(LPVOID, <span class="keyword">int</span> *, <span class="keyword">signed</span> <span class="keyword">int</span>, _DWORD))(*(_DWORD *)lpMem + <span class="number">12</span>))(lpMem, &amp;v7, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v7 == dwBytes )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = HeapAlloc(hHeap, <span class="number">0</span>, dwBytes);</span><br><span class="line">      lpMema = v5;</span><br><span class="line">      <span class="keyword">if</span> ( v5 )</span><br><span class="line">      &#123;</span><br><span class="line">        v6 = (*(<span class="keyword">int</span> (__stdcall **)(LPVOID, LPVOID, SIZE_T, _DWORD))(*(_DWORD *)v3 + <span class="number">12</span>))(v3, v5, dwBytes, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt;= <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          qmemcpy((<span class="keyword">void</span> *)a1, lpMema, dwBytes);</span><br><span class="line">          v6 = (*(<span class="keyword">int</span> (__stdcall **)(LPVOID, <span class="keyword">void</span> *, SIZE_T, _DWORD))(*(_DWORD *)v3 + <span class="number">12</span>))(</span><br><span class="line">                 v3,</span><br><span class="line">                 &amp;unk_27632368,</span><br><span class="line">                 ((dwBytes + <span class="number">3</span>) &amp; <span class="number">0xFFFFFFFC</span>) - dwBytes,</span><br><span class="line">                 <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        HeapFree(hHeap, <span class="number">0</span>, (LPVOID)lpMema);</span><br><span class="line">        result = v6;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">-2147024882</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">-2147418113</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分部来看：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">275e7015 e8ad19feff      call    MSCOMCTL!DllGetClassObject+0x41c83 (275c89c7)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/7.png?x-oss-process=style/yangruiqi.com" alt="7"></p>
<p>首先分配20个字节空间    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">275C89CA sub     esp, 14h        ; 分配20字节局部空间</span><br></pre></td></tr></table></figure>
<p>然后调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">275C89DA call    sub_275C876D</span><br></pre></td></tr></table></figure>
<p>这个call的功能是从样本读取dwBytes，这里是0CH字节返回到eax指向的内存地址。</p>
<p>关键call就是sub_275C876，进去看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:275C877C lea     ecx, [ebp+var_4]</span><br><span class="line">.text:275C877F push    4</span><br><span class="line">.text:275C8781 push    ecx</span><br><span class="line">.text:275C8782 push    ebx</span><br><span class="line">.text:275C8783 call    dword ptr [eax+0Ch]</span><br><span class="line">.text:275C8786 cmp     eax, esi</span><br><span class="line">.text:275C8788 jl      short loc_275</span><br></pre></td></tr></table></figure>
<p>读取4个字节到[ebp+var_4]，返回值和0比较，如果小于0，读取失败，转到失败处理，否则<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/8.png?x-oss-process=style/yangruiqi.com" alt="8"><br>分配0x8282字节空间，接着<br><img src="https://yangruiqi.oss-cn-beijing.aliyuncs.com/CVE-2012-0158/9.png?x-oss-process=style/yangruiqi.com" alt="9"></p>
<p>我们看到：275C87CB rep movsd此时edi就是前面读取的0x8082字节，然后复制过去，<br>返回值就是我们的shellcode；<br>ep movsd 所在的这层函数在溢出后能正常返回，上上层函数在返回时候才跳去执行shellcode。分析完成，我们看到其实漏洞发生的根本原因在于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:275C89F3 cmp     [ebp+dwBytes], 8</span><br><span class="line">.text:275C89F7 jb      loc_275D</span><br></pre></td></tr></table></figure>
<p>比较从样本读取过来的数据时候处理错误，这里应该是大于8个字节就转到错误处理，它写成了小于8个字节转到错误处理。而这个字节大小是我们可以控制的，所以当我们传递比如0x8282，那么程序就会读取样本相应位置可控的0x8282字节到堆空间，然后把这0x8282字节复制到0x127b7c地址，进而覆盖掉函数的返回地址，执行我们的shellcode。</p>
<h1 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h1><p>帖子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.52pojie.cn/thread-453723-1-1.html</span><br></pre></td></tr></table></figure></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">yangruiqi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/07/28/CVE-2012-0158-漏洞分析/">http://yoursite.com/2018/07/28/CVE-2012-0158-漏洞分析/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">manyouyou</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/漏洞分析/">漏洞分析</a><a class="post-meta__tags" href="/tags/栈溢出/">栈溢出</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://raw.githubusercontent.com/yangruiqiyr/MarkdownPhotos/master/收款码/zhifubao.jpg"><div class="post-qr-code__desc">支付宝打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="https://raw.githubusercontent.com/yangruiqiyr/MarkdownPhotos/master/收款码/weixin.jpg"><div class="post-qr-code__desc">微信打赏</div></div></div><div class="social-share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/08/08/Cpu-Spectre漏洞分析/"><i class="fa fa-chevron-left">  </i><span>Cpu Spectre漏洞分析</span></a></div><div class="next-post pull-right"><a href="/2018/07/16/熊猫烧香病毒分析报告/"><span>熊猫烧香病毒分析报告</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitment-container"></div><script>var gitment = new Gitment({
  owner: 'yangruiqiyr',
  repo: 'BlogGitment',
  oauth: {
    client_id: 'dfbfacd2fb59427cee9e',
    client_secret: 'a39b872c7d6ddf551a16ebf9a3d59ce9b57508bb'
  }
})
gitment.render('gitment-container')</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2018 By yangruiqi</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="www.yangruiqiyr.com">blog</a>!</div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.5"></script><script src="/js/fancybox.js?version=1.5.5"></script><script src="/js/sidebar.js?version=1.5.5"></script><script src="/js/copy.js?version=1.5.5"></script><script src="/js/fireworks.js?version=1.5.5"></script><script src="/js/transition.js?version=1.5.5"></script><script src="/js/scroll.js?version=1.5.5"></script><script src="/js/head.js?version=1.5.5"></script></body></html>